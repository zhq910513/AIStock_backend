一句话总览：你现在必须喂给模型的“硬数据”

你这套交易口径的标签是：

T 日入选 → entry = Open(T+1) → 看 T+1~T+3 的 High 是否达到 +5/+8

所以最硬的硬需求就两类：

交易日历（知道 T+1/T+2/T+3 是哪天，跳过休市）

日线 OHLCV（至少要有 Open / High / Close / Amount）

其他的都是“让模型更像个脑子”的增强项。

需要哪些表、每张表需要哪些数据（通俗版）
1) trading_calendar_day（交易日历）✅必须

你要给：

day：日期（YYYY-MM-DD）

is_trading_day：是否交易日（true/false）

有就更好：

prev_trading_day、next_trading_day（可选，算得出来）

market（如果你以后做多市场）

为什么必须：
不然 T+1/T+2/T+3 会在节假日/周末算错，标签全歪。

# 已经采用代码方式自动生成

2) fact_daily_ohlcv（日线事实表）✅必须

最少要给：

instrument_id：股票代码（建议统一成你们内部标准，比如 600519.SH 或 SZ000001，你定一个）

trading_day：日期（YYYY-MM-DD）

open：开盘价（必须）

high：最高价（必须）

close：收盘价（强烈建议，gap 风险需要）

amount：成交额（强烈建议，liquidity 标签需要）

最好也给：

low：最低价（可选，但通常也有）

volume：成交量（可选）

adj_factor / is_st / limit_up_px（增强：可交易性识别更准）

raw_hash / source（追溯用：来自哪个平台、哪条原始记录）

为什么必须：

标签需要 Open(T+1) 和 High(T+1..T+3)

辅助标签需要 Close(T)、amount

3) labeling_candidate（候选池）✅你现在已经有（模型“样本集合”来源）

你要确保它每天都有：

instrument_id（股票）

trading_day（T 日）

以及你用于候选池的那些字段（连板、板块、涨停类型等）可选

为什么它重要：
我们默认“训练/打标签/回测”只围绕候选池发生，否则你要做全市场数据就爆炸大。

4) model_training_label_3d（训练标签表）🚫你不用收集，系统会算

它由我们根据 trading_calendar_day + fact_daily_ohlcv 自动生成：

label_tp5_3d / label_tp8_3d

label_gap_risk / label_liquidity_ok / label_limitup_lock

你只要把前两张表的数据喂齐就行。

5)（增强项）让模型更聪明、更像“懂行情”——你后续可以逐步补

这些不影响先跑通，但会显著提升排序质量和解释能力：

板块/概念强度（日频）：比如板块涨跌幅、板块热度、资金流

市场情绪（日频）：涨停家数、跌停家数、连板高度、指数波动

高频摘要（T 日尾盘特征）：从 1mK/逐笔/五档做聚合特征（我们已有 intraday 表体系的方向）

这些会进入 feature store（特征表），训练时再 join。

你去收集数据时，最推荐的“最小数据包”

为了你最快闭环，我建议你先搞到：

必须（先闭环）

交易日历：至少覆盖你训练区间（比如最近 2 年）

日线 OHLCV：覆盖候选池涉及的所有票、所有 T 与 T+1..T+3

强烈建议（让推荐更“可交易”）

涨跌停相关：是否一字板、涨停价、封板状态（用于 lock 风险）

ST / 交易规则标记：10%/20% 规则不同会影响 lock 判断

不同平台数据样式不一致怎么办？

这事我最熟：别让模型层去适配平台差异，我们做一个“标准化入口（Normalizer）”。

我的处理策略（非常稳）

定义“标准内部格式”（我们系统只认一种）

instrument_id 统一（例如：600519.SH、000001.SZ）

日期统一 YYYY-MM-DD

价格统一 decimal（字符串或 float 都行，入库转 Decimal）

amount 统一为“元”（还是“万元”必须统一）

每个平台写一个 Adapter/Parser

THSAdapter：解析同花顺返回 → 标准结构

IFINDAdapter：解析 iFinD 返回 → 标准结构

CustomAdapter：解析你自有接口 → 标准结构

落库只落标准结构

fact_daily_ohlcv 永远只收标准字段

raw_payload（可选）存原始 JSON + raw_hash，便于追溯

单位/复权/币种不一致：必须在 adapter 里统一

amount 是元还是万元？volume 是手还是股？必须统一到一个口径

复权：模型标签用不复权日线最稳（因为交易按真实价格成交），如果平台给复权价要能切换为原始价

你问的关键句：你给我接口返回样例，我来解析成模型需要的样式吗？

可以，而且这是最省时间、最靠谱的方式。

你直接把每个平台的“日线接口返回样例”贴我（脱敏即可），我会给你：

字段映射表（平台字段 → 标准字段）

单位换算规则（元/万元、股/手、复权/不复权）

标准化后的示例输出（我会把一条样例转换出来给你看）

最终落库 schema 对照（对应 fact_daily_ohlcv 的列）

你现在只需要给我 3 类样例（最少）

为了我一次把解析写准，你每个平台给我这三样：

日线 OHLCV（单票多日 或 多票单日都行）

交易日历接口返回（如果平台提供；没有也行，你给一个“交易日列表”就够）

instrument_id 的代码样式说明

是 000001 还是 000001.SZ？

沪深怎么区分？港股/美股有没有？

你去抓接口的时候，优先把 Daily OHLCV + Calendar 这两块搞到手。只要这俩齐了，我们就能：
自动补齐数据 → 自动打 label → LightGBM 双头训练 → 自动激活 → 线上出快照轨迹，整条链路闭环。